spring.application.name=app-restaurante-api


# Configuración de base de datos MySQL (usa variables de entorno en producción)
# Railway proporciona: MYSQLHOST, MYSQLPORT, MYSQLDATABASE, MYSQLUSER, MYSQLPASSWORD
# También soporta: MYSQL_HOST, MYSQL_PORT, MYSQL_DATABASE, MYSQL_USER, MYSQL_PASSWORD (para compatibilidad)
# NOTA: No usar MYSQL_URL directamente porque viene en formato mysql:// y Spring necesita jdbc:mysql://
spring.datasource.url=jdbc:mysql://${MYSQLHOST:${MYSQL_HOST:localhost}}:${MYSQLPORT:${MYSQL_PORT:3306}}/${MYSQLDATABASE:${MYSQL_DATABASE:restaurante_db}}?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true&useUnicode=true&characterEncoding=UTF-8&createDatabaseIfNotExist=true
spring.datasource.username=${MYSQLUSER:${MYSQL_USER:root}}
spring.datasource.password=${MYSQLPASSWORD:${MYSQL_PASSWORD:1234}}

spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Configuración JPA/Hibernate
spring.jpa.hibernate.ddl-auto=${JPA_DDL_AUTO:update}
spring.jpa.show-sql=${JPA_SHOW_SQL:true}
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=false
spring.jpa.properties.hibernate.connection.autocommit=false

# Scripts SQL de inicialización (cambiar a 'never' después de la primera ejecución)
spring.sql.init.mode=${SQL_INIT_MODE:always}
spring.jpa.defer-datasource-initialization=true
spring.sql.init.continue-on-error=false


# Puerto del servidor (Railway asigna el puerto dinámicamente)
server.port=${PORT:8080}

# Thymeleaf (desactivar caché en desarrollo, activar en producción)
spring.thymeleaf.cache=${THYMELEAF_CACHE:false}

# Logging
logging.level.utp.edu.pe.restaurante=${LOG_LEVEL:INFO}

# Configuración de almacenamiento de archivos
app.upload.dir=${UPLOAD_DIR:uploads}
app.base.url=${BASE_URL:http://localhost:8080}

# Configuración de tamaño máximo de archivos
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Configuración Yape
app.yape.numero=${YAPE_NUMERO:908556931}
app.yape.codigo=${YAPE_CODIGO:908556931}
app.yape.whatsapp=${YAPE_WHATSAPP:908556931}
app.yape.qr.url=${YAPE_QR_URL:http://localhost:8080/uploads/yape/yape.jpeg}